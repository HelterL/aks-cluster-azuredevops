trigger:
  branches:
    include:
    - main

pool:
  vmImage: 'ubuntu-latest'

variables: 
  rsgroup: 'tfstate'
  backServiceArm: 'DevServiceConnection' 
  storageaccount: 'storagedesafiotf' 
  containername: 'tfstate' 
  key: 'azuredevops.tfstate'

steps:
- task: TerraformInstaller@1
  displayName: 'Install Terraform'
  inputs:
    terraformVersion: 'latest'

- task: TerraformTaskV4@4
  displayName: 'Init Terraform'
  inputs:
    provider: 'azurerm'
    command: 'init'
    backendServiceArm: 'DevServiceConnection'
    backendAzureRmResourceGroupName: '$(rsgroup)'
    backendAzureRmStorageAccountName: '$(storageaccount)'
    backendAzureRmContainerName: '$(containername)'
    backendAzureRmKey: '$(key)'